(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16558,        499]
NotebookOptionsPosition[     15405,        472]
NotebookOutlinePosition[     15749,        487]
CellTagsIndexPosition[     15706,        484]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "ToMatlab`"}]], "Input",
 CellChangeTimes->{{3.7838121994580345`*^9, 3.7838121994625854`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"25909a61-59b9-412a-9b3b-0cfb5db96e70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"xi", "*", "R"}], "-", 
      RowBox[{"S", "*", 
       RowBox[{"Ix", "/", "B"}], "*", "beta"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sigma"}], "*", "Ex"}], " ", "+", 
      RowBox[{"S", "*", 
       RowBox[{"Ix", "/", "N"}], "*", "beta"}]}], ",", " ", 
     RowBox[{
      RowBox[{"sigma", "*", "Ex"}], "-", 
      RowBox[{"gamma", "*", "Ix"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], "*", "gamma", "*", "Ix"}], "-", 
      RowBox[{"xi", "*", "R"}]}], ",", 
     RowBox[{"alpha", "*", "rho", "*", "Ix"}], ",", " ", 
     RowBox[{"1", "-", "beta"}], ",", " ", "0.5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "M"}], ",", " ", 
     RowBox[{
      RowBox[{"-", "k"}], "*", "M"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdot", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"xi", "*", "R"}], "-", 
      RowBox[{"S", "*", 
       RowBox[{"Ix", "/", "B"}], "*", "beta"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sigma"}], "*", "Ex"}], " ", "+", 
      RowBox[{"S", "*", 
       RowBox[{"Ix", "/", "N"}], "*", "beta"}]}], ",", " ", 
     RowBox[{
      RowBox[{"sigma", "*", "Ex"}], "-", 
      RowBox[{"gamma", "*", "Ix"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "alpha"}], ")"}], "*", "gamma", "*", "Ix"}], "-", 
      RowBox[{"xi", "*", "R"}]}], ",", 
     RowBox[{"alpha", "*", "rho", "*", "Ix"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "beta"}], ")"}], "-", 
      RowBox[{"u", "*", "M"}]}], ",", " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"k", "*", "u", "*", "M"}], ")"}]}], "+", "0.5"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", "Ex"}], ";"}]}], "Input",
 CellChangeTimes->{{3.798484126890812*^9, 3.7984841693771377`*^9}, {
  3.7984842620647607`*^9, 3.7984842645680685`*^9}, {3.798484305067605*^9, 
  3.7984843129654446`*^9}, {3.7984844095867615`*^9, 3.798484428247826*^9}, {
  3.798484487944677*^9, 3.7984845157288656`*^9}, {3.7984846595921545`*^9, 
  3.798484748400446*^9}, {3.7984848290021906`*^9, 3.7984848292804503`*^9}, {
  3.798484996554246*^9, 3.7984850001835365`*^9}, {3.798485325438815*^9, 
  3.798485437568077*^9}, {3.7984857290522327`*^9, 
  3.798485733391664*^9}},ExpressionUUID->"c1099f6a-1c1f-4d4e-b7aa-\
34c91220f02d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "xdot", "]"}]], "Input",
 CellChangeTimes->{{3.798484721466303*^9, 3.79848472508768*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"acf4c9a9-03f4-4d2e-b3d0-f4ef44c386d3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"beta", " ", "Ix", " ", "S"}], "B"]}], "+", 
        RowBox[{"R", " ", "xi"}]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "gamma"}], " ", "Ix"}], "+", 
        RowBox[{"Ex", " ", "sigma"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "alpha"}], ")"}], " ", "gamma", " ", "Ix"}], "-", 
        RowBox[{"R", " ", "xi"}]}]},
      {
       RowBox[{"alpha", " ", "Ix", " ", "rho"}]},
      {
       RowBox[{"1", "-", "beta", "-", 
        RowBox[{"M", " ", "u"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.5`"}], "-", 
        RowBox[{"k", " ", "M", " ", "u"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7984847254985766`*^9, 3.7984847502338715`*^9}, 
   3.798484831401772*^9, 3.798485445224625*^9},
 CellLabel->
  "Out[32]//MatrixForm=",ExpressionUUID->"96b5c4c1-a04c-41af-9b64-\
d9f2dd581026"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ydot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"y", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "S", ",", " ", "Ex", ",", " ", "Ix", ",", " ", "R", ",", " ", "D", 
         ",", " ", "M", ",", " ", "beta"}], "}"}], ",", "1"}], "}"}]}], "]"}],
    ".", "xdot"}]}], "\[IndentingNewLine]", 
 RowBox[{"yddot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"ydot", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "S", ",", " ", "Ex", ",", " ", "Ix", ",", " ", "R", ",", " ", "D", 
         ",", " ", "M", ",", " ", "beta"}], "}"}], ",", "1"}], "}"}]}], "]"}],
    ".", "xdot"}]}]}], "Input",
 CellChangeTimes->{{3.7984847670679007`*^9, 3.7984848128174753`*^9}, {
  3.798484848481385*^9, 3.79848487246552*^9}, {3.798484972943775*^9, 
  3.798484984784692*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"25ce212e-614c-47e3-bcce-b78eec1c135a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
  RowBox[{"Ex", " ", "sigma"}]}]], "Output",
 CellChangeTimes->{{3.7984848078836637`*^9, 3.7984848338960676`*^9}, {
   3.798484979909688*^9, 3.7984849853671255`*^9}, 3.7984854479473505`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"fc0435d2-768d-417c-8420-13a47820904e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "sigma"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
     RowBox[{"Ex", " ", "sigma"}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"beta", " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "gamma"}], " ", "Ix"}], "+", 
      RowBox[{"Ex", " ", "sigma"}]}], ")"}]}], "N"], "+", 
  FractionBox[
   RowBox[{"Ix", " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "0.5`"}], "-", 
      RowBox[{"k", " ", "M", " ", "u"}]}], ")"}]}], "N"], "+", 
  FractionBox[
   RowBox[{"beta", " ", "Ix", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"beta", " ", "Ix", " ", "S"}], "B"]}], "+", 
      RowBox[{"R", " ", "xi"}]}], ")"}]}], "N"]}]], "Output",
 CellChangeTimes->{{3.7984848078836637`*^9, 3.7984848338960676`*^9}, {
   3.798484979909688*^9, 3.7984849853671255`*^9}, 3.798485447951331*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"5798f2da-0e2a-4f43-895c-4fa4cd71826f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eta", "=", 
   RowBox[{"{", 
    RowBox[{"y", ",", " ", "ydot"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"eta", ".", "T", ".", "P", ".", "eta"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dVdt", "=", 
  RowBox[{"D", "[", 
   RowBox[{"V", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "S", ",", " ", "Ex", ",", " ", "Ix", ",", " ", "R", ",", " ", "D", ",",
         " ", "M", ",", " ", "beta"}], "}"}], ",", "1"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.79848526129877*^9, 3.7984853006870146`*^9}, {
  3.7984855248566585`*^9, 3.7984855789619856`*^9}, {3.798485618600006*^9, 
  3.798485683462529*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"42f61c25-e57b-4db2-94fc-b1f6f2d3f847"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"beta", " ", "Ix"}], "N"]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"beta", " ", "Ix"}], "N"], ",", 
         RowBox[{"-", "sigma"}], ",", 
         FractionBox[
          RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "sigma"}]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"beta", " ", "Ix"}], "N"], ",", 
         RowBox[{"-", "sigma"}], ",", 
         FractionBox[
          RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"beta", " ", "S"}], "N"]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"beta", " ", "Ix"}], "N"], ",", 
         RowBox[{"-", "sigma"}], ",", 
         FractionBox[
          RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex", ",", 
      RowBox[{
       FractionBox[
        RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
       RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix"}], "N"], ",", 
        RowBox[{"-", "sigma"}], ",", 
        FractionBox[
         RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
        FractionBox[
         RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex", ",", 
      RowBox[{
       FractionBox[
        RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
       RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix"}], "N"], ",", 
        RowBox[{"-", "sigma"}], ",", 
        FractionBox[
         RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
        FractionBox[
         RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex", ",", 
      RowBox[{
       FractionBox[
        RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
       RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix"}], "N"], ",", 
        RowBox[{"-", "sigma"}], ",", 
        FractionBox[
         RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
        FractionBox[
         RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"Ix", " ", "S"}], "N"]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ex", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"beta", " ", "Ix", " ", "S"}], "N"], "-", 
        RowBox[{"Ex", " ", "sigma"}]}]}], "}"}], ".", "T", ".", "P", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"beta", " ", "Ix"}], "N"], ",", 
         RowBox[{"-", "sigma"}], ",", 
         FractionBox[
          RowBox[{"beta", " ", "S"}], "N"], ",", "0", ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{"Ix", " ", "S"}], "N"]}], "}"}]}], "}"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.798485567103733*^9, {3.798485619078692*^9, 3.79848562667441*^9}, {
   3.798485675970559*^9, 3.79848568378467*^9}},
 CellLabel->"Out[57]=",ExpressionUUID->"be112dd9-a981-4857-bfa9-388b46af7e2f"]
}, Open  ]]
},
WindowSize->{759, 833},
WindowMargins->{{Automatic, -961}, {37, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 201, 3, 28, "Input",ExpressionUUID->"25909a61-59b9-412a-9b3b-0cfb5db96e70"],
Cell[762, 25, 2674, 73, 124, "Input",ExpressionUUID->"c1099f6a-1c1f-4d4e-b7aa-34c91220f02d"],
Cell[CellGroupData[{
Cell[3461, 102, 210, 3, 28, "Input",ExpressionUUID->"acf4c9a9-03f4-4d2e-b3d0-f4ef44c386d3"],
Cell[3674, 107, 1586, 51, 167, "Output",ExpressionUUID->"96b5c4c1-a04c-41af-9b64-d9f2dd581026"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5297, 163, 958, 26, 48, "Input",ExpressionUUID->"25ce212e-614c-47e3-bcce-b78eec1c135a"],
Cell[6258, 191, 362, 7, 50, "Output",ExpressionUUID->"fc0435d2-768d-417c-8420-13a47820904e"],
Cell[6623, 200, 1078, 32, 98, "Output",ExpressionUUID->"5798f2da-0e2a-4f43-895c-4fa4cd71826f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7738, 237, 817, 22, 67, "Input",ExpressionUUID->"42f61c25-e57b-4db2-94fc-b1f6f2d3f847"],
Cell[8558, 261, 6831, 208, 430, "Output",ExpressionUUID->"be112dd9-a981-4857-bfa9-388b46af7e2f"]
}, Open  ]]
}
]
*)

